var app = angular.module("trackwane", [	"ui.router", 'uiGmapgoogle-maps']);

app.config(function ($stateProvider, $urlRouterProvider) {
    $urlRouterProvider.otherwise("/dashboard");
    $stateProvider
        //.state('login', {url: "/", templateUrl: "pages/login.html"})
        //.state('logout', {url: "/logout", templateUrl: "pages/logout.html"})
		.state('reports', {
			url: "/reports",
			template: '<reports-page class="page" />',
			onEnter: [
				'services.reports',
				'services.trackers',
				function($reports, $trackers) {
					// fetch reports and populate applicationState
					// fetch trackers and populate applicationState
				}
			]
		})
		.state('timelines', {url: "/timelines", template: '<timelines-page class="page" />'})
		.state('notifications', {url: "/notifications", template: '<notifications-page class="page" />'})
        .state('dashboard', {
			onEnter: [
				'services.locations',
				'services.boundaries',
				'services.trackers',
				function($locations, $boundaries, $trackers) {
					// fetch trackers and populate applicationState
					// fetch locations and populate applicationState
					// fetch boundaries and populate applicationState
				}
			],
			url: "/dashboard",
			template: '<dashboard-page class="page" />'
		});
});

(function() {

	angular
		.module("trackwane")
		.component('dashboardPage', {
			template: (
				"<div class=\"canvas\">\n    <top-navigation />\n    <div style=\"flex-direction: row; display: flex; flex: 1\">\n        <dashboard-trackers style=\"overflow-y: scroll\" />\n        <dashboard-map />\n        <dashboard-tracker class=\"z-depth-5\" style=\"display: none; right: 10px; top: 85px;  z-index: 20000; background-color: #333; width: 300px; border-top: 1px #666 solid\" />\n        <dashboard-actions class=\"z-depth-5\" style=\"right: 10px; top: 85px;  z-index: 20000; background-color: #333; width: 210px; border-top: 1px #666 solid\" />\n    </div>\n</div>"
			)
		});
})();

(function() {

	angular
		.module("trackwane")
		.component('reportsPage', {
			template: (
				"<div class=\"canvas\">\n    <top-navigation />\n    <div style=\"flex-direction: row; display: flex; flex: 1\">\n        <div style=\"display: flex; flex: 1; flex-direction: column\">\n            <report-builder />\n            <saved-reports />\n            <scheduled-reports />\n        </div>\n        <report-tracker-picker  style=\"display: flex; flex: 1\" />\n        <report-viewer  style=\"display: flex; flex: 1\" />\n        <report-actions class=\"z-depth-5\" style=\"right: 10px; top: 85px;  z-index: 20000; background-color: #333; width: 210px; border-top: 1px #666 solid\" />\n    </div>\n</div>"
			)
		});
})();

(function() {

	angular
		.module("trackwane")
		.service('services.applicationState', [
			function() {
				this.trackers = [
					{identifier: "A SENSOR IDENTIFIER", speed: 12, icon: "http://www.nmr.ch.tum.de/images/stories/car.gif", coords: {longitude: -73, latitude: 45}},
					{identifier: "A SENSOR A", speed: 12, icon: "http://www.nmr.ch.tum.de/images/stories/car.gif", coords: {longitude: -72, latitude: 45}},
					{identifier: "A SENSOR B", speed: 12, icon: "http://www.nmr.ch.tum.de/images/stories/car.gif", coords: {longitude: -73, latitude: 43}},
					{identifier: "A SENSOR C", speed: 12, icon: "http://www.nmr.ch.tum.de/images/stories/car.gif", coords: {longitude: -69.50, latitude: 44.22}},
					{identifier: "A SENSOR IDENTIFIER", speed: 12},
					{identifier: "ANOTHER SENSOR ID", speed: 0, location: "Pulham Road, Battersea"},
					{identifier: "CTA Bus 2034 on Route 6", speed: 43, location: "King's Road, Chelsea"},
					{identifier: "ANOTHER SENSOR ID", speed: 0, location: "Sydenham High Street, Sydenham"},
					{identifier: "CTA Bus 12 on Route 6", speed: 21},
					{identifier: "CTA Bus 93 on Route 12", speed: 3},
					{identifier: "CTA Bus 86 on Route 1", speed: 7},
					{identifier: "CTA Bus 123 on Route 5", speed: 0},
					{identifier: "CTA Bus 93 on Route 12", speed: 3},
					{identifier: "CTA Bus 86 on Route 1", speed: 7},
					{identifier: "CTA Bus 123 on Route 5", speed: 0},
					{identifier: "CTA Bus 93 on Route 12", speed: 3},
					{identifier: "CTA Bus 86 on Route 1", speed: 7},
					{identifier: "CTA Bus 123 on Route 5", speed: 0}
				];

				_.each(this.trackers, function(tracker) {
					tracker.icon = "http://www.nmr.ch.tum.de/images/stories/car.gif";
					tracker.speed = chance.integer({min: 0, max: 80});
				});
			}
		]);
})();

(function() {
	class Authenticator {

	    constructor() {
	    }

		get token() {

		}

		get isAuthenticated() {

		}

		authenticate(email, password) {

		}
	}
})();

(function() {

	angular
		.module("trackwane")
		.service('services.boundaries', [
			"$http",
			function($http) {
			}
		]);
})();

(function() {

	angular
		.module("trackwane")
		.service('services.locations', [
			"$http",
			function($http) {
			}
		]);
})();

(function() {

	angular
		.module("trackwane")
		.service('services.reports', [
			"$http",
			function($http) {
			}
		]);
})();

(function() {

	angular
		.module("trackwane")
		.service('services.trackers', [
			"$http",
			function($http) {
			}
		]);
})();

(function() {
	angular
		.module("trackwane")
		.component('dashboardActions', {
			controller: function() {
			},
			template: (
				"<div>\n    <p style=\"padding: 25px; font-weight: bold; font-size: 18px; padding-bottom: 0; padding-top: 0\">Actions</p>\n    <div style=\"padding: 25px; padding-top: 5px\">\n        <p>List Locations</p>\n        <p>List Trackers</p>\n        <p>List Boundaries</p>\n        <p>Show/Hide Locations</p>\n        <p>Show/Hide Boundaries</p>\n        <p>Show/Hide Trackers</p>\n        <p>Add New Tracker</p>\n        <p>Add New Location</p>\n        <p>Add New Boundary</p>\n    </div>\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component("dashboardMap", {
			controller: [
				"services.applicationState",
				function($applicationState) {
					this.map = { center: { latitude: 45, longitude: -73 }, zoom: 8 };
					this.trackers = $applicationState.trackers;
					this.showTracker = function(marker, event, tracker) {
						console.log(tracker);
					};
				}
			],
			template:
				"<ui-gmap-google-map center='$ctrl.map.center' zoom='$ctrl.map.zoom'>\n    <ui-gmap-markers models=\"$ctrl.trackers\" coords=\"'coords'\" icon=\"'icon'\" idkey=\"'identifier'\" click=\"$ctrl.showTracker\"></ui-gmap-markers>\n</ui-gmap-google-map>"
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('dashboardTracker', {
			controller: function() {
			},
			template: (
				"<div>\n    <p style=\"padding: 25px; font-weight: bold; font-size: 18px; padding-bottom: 0; padding-top: 0\">CTA Bus 2034 on Route 6</p>\n    <image src=\"/images/sample-closeup.png\" style=\"width: 300px\" />\n    <div style=\"padding: 25px; padding-top: 5px\">\n        <ul>\n            <li style=\"color: #6699cc\">Driver</li>\n            <li>John Smith</li>\n            <li style=\"margin-top: 10px; color: #6699cc\">Speed</li>\n            <li>23mph</li>\n            <li style=\"margin-top: 10px; color: #6699cc\">Location</li>\n            <li>123 Cheltenham Road, Battersea, London</li>\n            <li style=\"margin-top: 10px; color: #6699cc\">Places Nearby</li>\n            <li>Luigi Pizzeria (0.2m)</li>\n            <li>IGA Supermarket (0.4m)</li>\n            <li>Hotel Hilton (1.3m)</li>\n        </ul>\n    </div>\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('dashboardTrackers', {
			controller: [
				"services.applicationState",
				function($applicationState) {
					this.trackers = $applicationState.trackers;
				}
			],
			template: (
				"<div style=\"overflow: hidden\">\n    <ul style=\"border-top: 1px solid #777; margin-top: 0\">\n        <li style=\"padding: 10px; font-weight: bold; border-bottom: 1px solid #777\">Trackers</li>\n        <li ng-repeat=\"tracker in $ctrl.trackers\" style=\"padding: 10px; padding-bottom: 15px; border-bottom: 1px solid #777\">\n            <i class=\"material-icons\" style=\"position: relative; top: 5px\">directions_bus</i>\n            <span style=\"margin-left: 5px\">{{tracker.identifier}}</span>\n            <p style=\"margin-bottom: 0; margin-left: 33px; margin-top: 3px; font-size: 12px\">\n                <span ng-if=\"tracker.speed == 0\">Stopped</span>\n                <span ng-if=\"tracker.speed > 0\">Moving, {{tracker.speed}}mph</span>\n                <br/><span>{{tracker.location}}</span>\n            </p>\n        </li>\n    </ul>\n</div>"

			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('reportActions', {
			controller: function() {
			},
			template: (
				"<div>\n    SAVE REPORT\n    EMAIL REPORT\n    SCHEDULE REPORT\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('reportBuilder', {
			controller: function() {
			},
			template: (
				"<div>\n    Date From:\n    Date To:\n    Report Type:\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('savedReports', {
			controller: function() {
			},
			template: (
				"<div>\n    SAVED REPORTS ARE SHOWN HERE\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('scheduledReports', {
			controller: function() {
				this.scheduled_reports = [
					{
						name: "Monthly Speed Report",
						type: 'speed',
						trackers: [{organization: 'ssdfsfd', key: '3dxXed3'}],
						frequency: 'weekly',
						recipients: ['sdfsdf@sfsdf.com'],
						startsOn: '2017-02-01'
					}
				];
			},
			template: (
				"<div>\n    SCHEDULED REPORTS\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('reportTrackerPicker', {
			controller: function() {
				this.trackers = [
					{identifier: "A SENSOR IDENTIFIER"},
					{identifier: "A SENSOR A"},
					{identifier: "A SENSOR B"},
					{identifier: "A SENSOR C"}
				];
			},
			template: (
				"<div>\n    <ul>\n        <li>Trackers</li>\n        <li ng-repeat=\"tracker in $ctrl.trackers\">\n\n            <input type=\"checkbox\" value=\"false\" name=\"tracker\">\n            <i class=\"material-icons\" style=\"position: relative; top: 5px\">directions_bus</i>\n            {{tracker.identifier}}\n            </input>\n        </li>\n    </ul>\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('reportViewer', {
			controller: function() {
			},
			template: (
				"<div>\n    VIEWER\n</div>"
			)
		});
})();

(function() {
	angular
		.module("trackwane")
		.component('topNavigation', {
			controller: function() {
			},
			template: (
				"<div class=\"wrapper\">\n    <h4>Trackwane</h4>\n    <ul>\n        <li><a ui-sref=\"dashboard\">Dashboard</a></li>\n        <li class=\"sep\">|</li>\n        <li><a ui-sref=\"timelines\">Timelines</a></li>\n        <li class=\"sep\">|</li>\n        <li><a ui-sref=\"reports\">Reports</a></li>\n        <li class=\"sep\">|</li>\n        <li><a ui-sref=\"notifications\">Notifications</a></li>\n        <li class=\"sep\">|</li>\n        <li><a ui-sref=\"access-control\">Access Control</a></li>\n    </ul>\n    <ul style=\"float: right; margin-right: 30px; margin-top: 25px\">\n        Olivier Kouame\n        <li><i class=\"material-icons\" style=\"position: relative; top: 5px\">person</i></li>\n        <li>Sign Out</li>\n    </ul>\n</div>"
			)
		});
})();
